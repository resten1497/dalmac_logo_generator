<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- 엑셀 파싱용 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fabric@5.3.0/dist/fabric.min.js"></script>
    <script async src="https://cdn.jsdelivr.net/npm/piexifjs"></script>
    <!-- 이미지 압축용 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  </head>
  <body>
    <input type="file" id="excelFile" />
    js 복사 편집
    <script>
      document
        .getElementById("excelFile")
        .addEventListener("change", async function (e) {
          const file = e.target.files[0];
          const reader = new FileReader();

          reader.onload = async function (evt) {
            const data = new Uint8Array(evt.target.result);
            const workbook = XLSX.read(data, { type: "array" });
            const sheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[sheetName];
            const json = XLSX.utils.sheet_to_json(worksheet);

            await generateZippedImages(json);
          };

          reader.readAsArrayBuffer(file);
        });

      async function generateZippedImages(dataArray) {
        const zip = new JSZip();

        for (let i = 0; i < dataArray.length; i++) {
          const row = dataArray[i];
          const dataUrl = await createImageAsDataUrl(row);

          //   // base64 형식에서 실제 바이너리 데이터 추출
          //   const base64Data = dataUrl.split(",")[1];
          //   zip.file(`image_${i + 1}.jpg`, base64Data, { base64: true });
        }

        // // 압축하고 다운로드
        // zip.generateAsync({ type: "blob" }).then(function (content) {
        //   saveAs(content, "images.zip");
        // });
      }

      function createImageAsDataUrl(row) {
        console.log(row);
      }
    </script>
  </body>
</html>
